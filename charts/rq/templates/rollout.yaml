# wait for 1.0.1
# apiVersion: argoproj.io/v1alpha1
# kind: Rollout
# metadata:
#   name: {{ include "rq.fullname" . }}
# spec:
#   replicas: {{ .Values.replicaCount }}
#   workloadRef:
#     apiVersion: apps/v1
#     kind: Deployment
#     name: {{ include "rq.fullname" . }}
#   strategy:
#     canary:
#       # Reference to a Service which the controller will update to point to the canary ReplicaSet
#       canaryService: {{  .Values.strategy.canaryService }}
#       # Reference to a Service which the controller will update to point to the stable ReplicaSet
#       stableService: {{  .Values.strategy.stableService }}
#       trafficRouting:
#         nginx:
#           # Reference to an Ingress which has a rule pointing to the stable service (e.g. rollouts-demo-stable)
#           # This ingress will be cloned with a new name, in order to achieve NGINX traffic splitting.
#           stableIngress: {{  .Values.strategy.trafficRouting.nginx.stableIngress }}
#       steps:
#       - setWeight: 20
#       # The following pause step will pause the rollout indefinitely until manually resumed.
#       # Rollouts can be manually resumed by running `kubectl argo rollouts promote ROLLOUT`
#       - pause: {}
#       - setWeight: 40
#       - pause: {duration: 40s}
#       - setWeight: 60
#       - pause: {duration: 20s}
#       - setWeight: 80
#       - pause: {duration: 20s}